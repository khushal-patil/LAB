CREATE TABLE O_ROLLCALL(rollno NUMBER(10),name VARCHAR2(30),address VARCHAR2(30)); 
CREATE TABLE N_ROLLCALL(rollno NUMBER(10),name VARCHAR2(30),address VARCHAR2(30)); 
 
INSERT INTO O_ROLLCALL VALUES(1,'Khushal Patil','Dhule'); 
INSERT INTO O_ROLLCALL VALUES(2,'Yash Patil','Jalgaon'); 
INSERT INTO O_ROLLCALL VALUES(3,'Aayush Patil','Dhule'); 
INSERT INTO O_ROLLCALL VALUES(4,'Aryan Patil','Pune'); 
INSERT INTO O_ROLLCALL VALUES(5,'Chaitanya Mitkari','Pune'); 
 
INSERT INTO N_ROLLCALL VALUES(5,'Chaitanya Mitkari','Pune'); 
INSERT INTO N_ROLLCALL VALUES(6,'Tejas Danane','PUNE'); 
INSERT INTO N_ROLLCALL VALUES(7,'Gaurav Pawar','Kolhapur'); 
INSERT INTO N_ROLLCALL VALUES(8,'Pranav Patil','Jalgaon'); 
 
CREATE OR REPLACE PROCEDURE MERGE_ROLLCALLS IS 
      CURSOR ROLLCALL_CURSOR(P_ROLLNO O_ROLLCALL.ROLLNO%TYPE) IS 
      SELECT ROLLNO, NAME, ADDRESS FROM O_ROLLCALL WHERE ROLLNO = P_ROLLNO; 
 
      V_ROLLNO N_ROLLCALL.ROLLNO%TYPE; 
      V_NAME N_ROLLCALL.NAME%TYPE; 
      V_ADDRESS N_ROLLCALL.ADDRESS%TYPE; 
      V_ROWS_MERGED INTEGER := 0; 
 
BEGIN 
   
   FOR RECORD IN (SELECT DISTINCT ROLLNO FROM O_ROLLCALL) LOOP 
       OPEN ROLLCALL_CURSOR(RECORD.ROLLNO); 
        
       LOOP 
           FETCH ROLLCALL_CURSOR INTO V_ROLLNO, V_NAME, V_ADDRESS; 
           EXIT WHEN ROLLCALL_CURSOR%NOTFOUND; 
 
           SELECT COUNT(*) INTO V_ROWS_MERGED FROM N_ROLLCALL WHERE ROLLNO = 
V_ROLLNO; 
           IF V_ROWS_MERGED = 0 THEN 
               INSERT INTO N_ROLLCALL (ROLLNO, NAME, ADDRESS) 
               VALUES (V_ROLLNO, V_NAME, V_ADDRESS); 
           END IF; 
       END LOOP; 
 
   CLOSE ROLLCALL_CURSOR; 
   END LOOP; 
   COMMIT; 
   DBMS_OUTPUT.PUT_LINE('RECORDS MERGED FROM O_ROLLCALL TO N_ROLLCALL.'); 
 
EXCEPTION 
   WHEN OTHERS THEN 
       ROLLBACK; 
       DBMS_OUTPUT.PUT_LINE('AN ERROR OCCURRED: ' || SQLERRM); 
END; 
/ 
 
SELECT * FROM O_ROLLCALL; 
 

SELECT * FROM N_ROLLCALL; 
 
BEGIN 
   MERGE_ROLLCALLS; 
END; 
/ 
SELECT * FROM O_ROLLCALL; 
SELECT * FROM N_ROLLCALL ORDER BY ROLLNO; 